(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{8195:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return n(870)}])},9046:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var l=n(5893),r=n(1664),a=n.n(r),i=n(1013),o=n(7294);function s(e){let{children:t}=e,[n,r]=(0,o.useState)(null),[a,s]=(0,o.useState)(null),[c,g]=(0,o.useState)(!1);(0,o.useEffect)(()=>{r((0,i.cY)()),s((0,i.Ms)())},[]);let u="ADMIN"===n,m="SR_REGISTRAR"===n,h="DO"===n;return(0,l.jsxs)("div",{style:{minHeight:"100vh",display:"flex",background:"#f6f6f6",fontFamily:"sans-serif"},children:[(0,l.jsxs)("aside",{className:"print-hidden",onMouseEnter:()=>g(!1),onMouseLeave:()=>g(!0),style:{width:c?"70px":"240px",background:"#0C512F",color:"white",transition:"width 0.25s ease",overflow:"hidden",boxShadow:"2px 0 5px rgba(0,0,0,0.1)"},children:[(0,l.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,l.jsx)("img",{src:"/ogra-logo.png",alt:"OGRA Logo",style:{width:"36px",height:"36px",objectFit:"contain"}}),!c&&(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontWeight:700,fontSize:"0.95rem",lineHeight:"1.2"},children:"OGRA Dashboard"}),(0,l.jsx)("div",{style:{fontSize:"0.7rem",opacity:.8},children:"ADMIN"===n?"REGISTRAR":"".concat(a||"DO User"," (").concat(n||"No Role",")")})]})]}),(0,l.jsxs)("nav",{style:{padding:"0.75rem 0.5rem"},children:[(0,l.jsx)(d,{href:"/admin",label:"Dashboard",collapsed:c}),(u||m||h)&&(0,l.jsx)(d,{href:"/admin/complaints",label:"Complaints",collapsed:c}),(h||u)&&(0,l.jsx)(d,{href:"/admin/do",label:"DO Dashboard",collapsed:c}),(u||m)&&(0,l.jsx)(d,{href:"/admin/company-dashboard",label:"Company Dashboard",collapsed:c}),u&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d,{href:"/admin/users",label:"Manage Users",collapsed:c}),(0,l.jsx)(d,{href:"/admin/master-data",label:"Form Settings",collapsed:c})]})]}),(0,l.jsx)("div",{style:{marginTop:"auto",padding:"1rem",borderTop:"1px solid rgba(255,255,255,0.15)"},children:(0,l.jsx)("button",{onClick:()=>{(0,i.qz)(),window.location.href="/admin/login"},style:{width:"100%",padding:"0.5rem",background:"#3AA469",border:"none",borderRadius:"4px",color:"white",fontSize:"0.8rem",cursor:"pointer"},children:c?"⎋":"Logout"})})]}),(0,l.jsx)("main",{style:{flex:1,padding:"1.5rem"},children:(0,l.jsx)("div",{style:{maxWidth:1300,margin:"0 auto"},children:t})})]})}function d(e){let{href:t,label:n,collapsed:r}=e;return(0,l.jsx)("div",{style:{marginBottom:"0.3rem"},children:(0,l.jsxs)(a(),{href:t,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.45rem 0.6rem",borderRadius:"6px",textDecoration:"none",color:"white",fontSize:"0.85rem",transition:"background 0.2s, transform 0.1s"},children:[(0,l.jsx)("span",{style:{width:"8px",height:"8px",background:"#3AA469",borderRadius:"50%"}}),!r&&(0,l.jsx)("span",{style:{fontSize:"0.85rem"},children:n})]})})}},3139:function(e,t,n){"use strict";n.d(t,{S:function(){return r}});let l="https://complaint.ogra.org.pk";if(!l){let{protocol:e,hostname:t}=window.location;l="".concat(e,"//").concat(t,":5000")}l||(l="http://localhost:5000");let r="https://complaint.ogra.org.pk"},1013:function(e,t,n){"use strict";function l(){return localStorage.getItem("token")||null}function r(e){e&&localStorage.setItem("token",e)}function a(){localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("username")}function i(){let e=l();return e?{Authorization:"Bearer "+e}:{}}function o(e,t){e&&localStorage.setItem("role",e),t&&localStorage.setItem("username",t)}function s(){return localStorage.getItem("role")}function d(){return localStorage.getItem("username")}n.d(t,{$V:function(){return i},IO:function(){return o},LP:function(){return l},Ms:function(){return d},cY:function(){return s},o4:function(){return r},qz:function(){return a}})},870:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var l=n(5893),r=n(9046),a=n(7294),i=n(7066),o=n(3139),s=n(1013);function d(){let[e,t]=(0,a.useState)({total:0,pending:0,inProgress:0,closed:0,overdue:0,avgResolutionDays:null}),[n,d]=(0,a.useState)([]),[g,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)("");return(0,a.useEffect)(()=>{(async()=>{u(!0),h("");try{let e=(0,s.$V)(),n=(await i.Z.get(o.S+"/api/users?role=DO",{headers:e})).data||[],l=[],r=1,a=1;do{let t=(await i.Z.get(o.S+"/api/complaints?page="+r,{headers:e})).data||{};l=l.concat(t.items||[]),a=t.pages||1,r+=1}while(r<=a);let c=new Date,g=l.length,u=0,m=0,h=0,f=0,p=0,x=0,y={},j=e=>{if(!e)return null;if(!y[e]){let t=n.find(t=>t.username===e)||{};y[e]={rawUsername:e,username:"adminogra"===e?"SR. REGISTRAR":e,email:t.email||"",totalAssigned:0,pending:0,inProgress:0,closed:0,overdue:0,totalResolutionDays:0,closedCount:0}}return y[e]};l.forEach(e=>{var t,n;let l=(null===(t=e.status)||void 0===t?void 0:t.name)||"",r=e.createdAt?new Date(e.createdAt):null,a=e.updatedAt?new Date(e.updatedAt):null;if("Pending"===l?u++:"In Progress"===l?m++:"Closed"===l&&h++,r&&"Closed"!==l){let e=new Date(r.getTime());e.setDate(e.getDate()+10),c>e&&f++}if("Closed"===l&&r&&a){let e=a-r;!isNaN(e)&&e>=0&&(p+=e/864e5,x++)}let i=(null===(n=e.assignedTo)||void 0===n?void 0:n.username)||null,o=j(i);if(o){if(o.totalAssigned++,"Pending"===l)o.pending++;else if("In Progress"===l)o.inProgress++;else if("Closed"===l&&(o.closed++,r&&a)){let e=a-r;!isNaN(e)&&e>=0&&(o.totalResolutionDays+=e/864e5,o.closedCount++)}if(r&&"Closed"!==l){let e=new Date(r.getTime());e.setDate(e.getDate()+10),c>e&&o.overdue++}}});let v=x>0?p/x:null,b=Object.values(y).map(e=>({...e,avgResolutionDays:e.closedCount>0?e.totalResolutionDays/e.closedCount:null}));t({total:g,pending:u,inProgress:m,closed:h,overdue:f,avgResolutionDays:v}),d(b)}catch(e){console.error(e),h("Failed to load dashboard metrics")}finally{u(!1)}})()},[]),(0,l.jsxs)(r.Z,{children:[(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h1",{className:"text-ogra-green",style:{fontSize:"1.5rem",fontWeight:700},children:"Dashboard"}),(0,l.jsx)("p",{style:{fontSize:"1rem",color:"#000000ff",fontWeight:"bold"},children:"Overview of complaints received, SLA (10 days), and dealing officer performance."}),g&&(0,l.jsx)("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem"},children:"Loading metrics…"}),m&&(0,l.jsx)("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem",color:"#B91C1C"},children:m}),!g&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginTop:"0.75rem"},children:[(0,l.jsx)(c,{label:"Total Complaints",value:e.total,valueColor:"#000000ff"}),(0,l.jsx)(c,{label:"Pending",value:e.pending,valueColor:"#DC2626"}),(0,l.jsx)(c,{label:"In Progress",value:e.inProgress,valueColor:"#2563EB"}),(0,l.jsx)(c,{label:"Closed",value:e.closed,valueColor:"#059669"}),(0,l.jsx)(c,{label:"Overdue (10+ days)",value:e.overdue,valueColor:"#B91C1C"}),(0,l.jsx)(c,{label:"Avg Resolution (days)",value:null!=e.avgResolutionDays?e.avgResolutionDays.toFixed(1):"-",valueColor:"#0C512F"})]}),n.length>0&&(0,l.jsxs)("div",{className:"card",style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#ffffff",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",borderRadius:"10px"},children:[(0,l.jsx)("h2",{className:"text-ogra-green",style:{fontSize:"1.05rem",marginBottom:"0.5rem"},children:"Dealing Officer Performance"}),(0,l.jsx)("div",{style:{overflowX:"auto"},children:(0,l.jsxs)("table",{style:{width:"100%",fontSize:"0.85rem",borderCollapse:"collapse",borderRadius:"10px"},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{style:{background:"#0C512F",color:"white"},children:[(0,l.jsx)("th",{align:"left",style:{padding:12},children:"DO"}),(0,l.jsx)("th",{align:"left",style:{padding:12},children:"Email"}),(0,l.jsx)("th",{align:"right",style:{padding:12},children:"Assigned"}),(0,l.jsx)("th",{align:"right",style:{padding:12},children:"Pending"}),(0,l.jsx)("th",{align:"right",style:{padding:12},children:"In Progress"}),(0,l.jsx)("th",{align:"right",style:{padding:12},children:"Closed"}),(0,l.jsx)("th",{align:"right",style:{padding:12},children:"Overdue"}),(0,l.jsx)("th",{align:"right",style:{padding:12},children:"Avg Days to Close"})]})}),(0,l.jsx)("tbody",{children:n.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{style:{padding:8},children:e.username}),(0,l.jsx)("td",{style:{padding:8},children:e.email||"-"}),(0,l.jsx)("td",{style:{padding:8},align:"right",children:e.totalAssigned}),(0,l.jsx)("td",{style:{padding:8},align:"right",children:e.pending}),(0,l.jsx)("td",{style:{padding:8},align:"right",children:e.inProgress}),(0,l.jsx)("td",{style:{padding:8},align:"right",children:e.closed}),(0,l.jsx)("td",{style:{padding:8},align:"right",children:e.overdue}),(0,l.jsx)("td",{style:{padding:8},align:"right",children:null!=e.avgResolutionDays?e.avgResolutionDays.toFixed(1):"-"})]},e.rawUsername))})]})})]}),(0,l.jsxs)("div",{className:"card",style:{marginTop:"1rem"},children:[(0,l.jsx)("h2",{className:"text-ogra-green",style:{fontSize:"1.1rem"},children:"Welcome"}),(0,l.jsx)("p",{style:{fontSize:"0.9rem",color:"#4B5563",marginTop:"0.3rem"},children:"Use the navigation on the left to manage complaints, DO assignments, company dashboard and form settings."})]})]})]}),(0,l.jsx)("footer",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"1.0rem",color:"#000000ff"},children:"All copyright reserve @ 2025 Developed BY OGRA IT DEPARTMENT"})]})}function c(e){let{label:t,value:n,valueColor:r}=e;return(0,l.jsxs)("div",{className:"kpi-card",style:{borderRadius:12,padding:"1rem 1.2rem",background:"#8ff8a1ff",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",border:"1px solid #e5e7eb",transition:"all 0.3s",cursor:"pointer"},children:[(0,l.jsx)("div",{style:{fontSize:"0.85rem",color:"#000000ff",marginBottom:"0.15rem"},children:t}),(0,l.jsx)("div",{style:{fontSize:"1.4rem",color:r,fontWeight:700},children:n})]})}}},function(e){e.O(0,[66,664,888,774,179],function(){return e(e.s=8195)}),_N_E=e.O()}]);