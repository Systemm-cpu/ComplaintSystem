(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{5366:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/do",function(){return n(5622)}])},9046:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(5893),a=n(1664),i=n.n(a),o=n(1013),s=n(7294);function l(e){let{children:t}=e,[n,a]=(0,s.useState)(null),[i,l]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a((0,o.cY)()),l((0,o.Ms)())},[]);let h="ADMIN"===n,g="SR_REGISTRAR"===n,m="DO"===n;return(0,r.jsxs)("div",{style:{minHeight:"100vh",display:"flex",background:"#f6f6f6",fontFamily:"sans-serif"},children:[(0,r.jsxs)("aside",{className:"print-hidden",onMouseEnter:()=>u(!1),onMouseLeave:()=>u(!0),style:{width:c?"70px":"240px",background:"#0C512F",color:"white",transition:"width 0.25s ease",overflow:"hidden",boxShadow:"2px 0 5px rgba(0,0,0,0.1)"},children:[(0,r.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,r.jsx)("img",{src:"/ogra-logo.png",alt:"OGRA Logo",style:{width:"36px",height:"36px",objectFit:"contain"}}),!c&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:700,fontSize:"0.95rem",lineHeight:"1.2"},children:"OGRA Dashboard"}),(0,r.jsx)("div",{style:{fontSize:"0.7rem",opacity:.8},children:"ADMIN"===n?"REGISTRAR":"".concat(i||"DO User"," (").concat(n||"No Role",")")})]})]}),(0,r.jsxs)("nav",{style:{padding:"0.75rem 0.5rem"},children:[(0,r.jsx)(d,{href:"/admin",label:"Dashboard",collapsed:c}),(h||g||m)&&(0,r.jsx)(d,{href:"/admin/complaints",label:"Complaints",collapsed:c}),(m||h)&&(0,r.jsx)(d,{href:"/admin/do",label:"DO Dashboard",collapsed:c}),(h||g)&&(0,r.jsx)(d,{href:"/admin/company-dashboard",label:"Company Dashboard",collapsed:c}),h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{href:"/admin/users",label:"Manage Users",collapsed:c}),(0,r.jsx)(d,{href:"/admin/master-data",label:"Form Settings",collapsed:c})]})]}),(0,r.jsx)("div",{style:{marginTop:"auto",padding:"1rem",borderTop:"1px solid rgba(255,255,255,0.15)"},children:(0,r.jsx)("button",{onClick:()=>{(0,o.qz)(),window.location.href="/admin/login"},style:{width:"100%",padding:"0.5rem",background:"#3AA469",border:"none",borderRadius:"4px",color:"white",fontSize:"0.8rem",cursor:"pointer"},children:c?"⎋":"Logout"})})]}),(0,r.jsx)("main",{style:{flex:1,padding:"1.5rem"},children:(0,r.jsx)("div",{style:{maxWidth:1300,margin:"0 auto"},children:t})})]})}function d(e){let{href:t,label:n,collapsed:a}=e;return(0,r.jsx)("div",{style:{marginBottom:"0.3rem"},children:(0,r.jsxs)(i(),{href:t,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.45rem 0.6rem",borderRadius:"6px",textDecoration:"none",color:"white",fontSize:"0.85rem",transition:"background 0.2s, transform 0.1s"},children:[(0,r.jsx)("span",{style:{width:"8px",height:"8px",background:"#3AA469",borderRadius:"50%"}}),!a&&(0,r.jsx)("span",{style:{fontSize:"0.85rem"},children:n})]})})}},9875:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(5893);function a(e){let{tone:t="gray",children:n}=e,a={};switch(t){case"green":a={background:"#0C512F"};break;case"yellow":a={background:"#D97706"};break;case"blue":a={background:"#2563EB"};break;case"red":a={background:"#DC2626"};break;default:a={background:"#6B7280"}}return(0,r.jsx)("span",{style:{display:"inline-block",padding:"3px 8px",borderRadius:"6px",fontSize:"0.75rem",fontWeight:600,color:"white",textTransform:"capitalize",...a},children:n})}},3139:function(e,t,n){"use strict";n.d(t,{S:function(){return a}});let r="https://complaint.ogra.org.pk";if(!r){let{protocol:e,hostname:t}=window.location;r="".concat(e,"//").concat(t,":5000")}r||(r="http://localhost:5000");let a="https://complaint.ogra.org.pk"},1013:function(e,t,n){"use strict";function r(){return localStorage.getItem("token")||null}function a(e){e&&localStorage.setItem("token",e)}function i(){localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("username")}function o(){let e=r();return e?{Authorization:"Bearer "+e}:{}}function s(e,t){e&&localStorage.setItem("role",e),t&&localStorage.setItem("username",t)}function l(){return localStorage.getItem("role")}function d(){return localStorage.getItem("username")}n.d(t,{$V:function(){return o},IO:function(){return s},LP:function(){return r},Ms:function(){return d},cY:function(){return l},o4:function(){return a},qz:function(){return i}})},5622:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var r=n(5893),a=n(7294),i=n(7066),o=n(9046),s=n(3139),l=n(1013),d=n(1163),c=n(1664),u=n.n(c),h=n(9875);function g(e){let{children:t,variant:n="primary",disabled:a,...i}=e,o={};return"primary"===n&&(o={background:a?"#9ca3af":"#0C512F",color:"white"}),"ghost"===n&&(o={background:"white",border:"2px solid #0C512F",color:"#0C512F"}),"danger"===n&&(o={background:a?"#fca5a5":"#dc2626",color:"white"}),(0,r.jsx)("button",{disabled:a,style:{padding:"0.45rem 1rem",borderRadius:"6px",cursor:a?"not-allowed":"pointer",fontSize:"0.85rem",fontWeight:600,transition:"0.2s",border:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.35rem",...o},...i,children:t})}function m(){let[e,t]=(0,a.useState)({items:[],total:0,pages:1,page:1}),[n,c]=(0,a.useState)([]),[m,p]=(0,a.useState)({}),[f,x]=(0,a.useState)([]),[y,j]=(0,a.useState)(null),b=(0,d.useRouter)(),S=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=new URLSearchParams;n.set("page",String(e)),y&&n.set("statusId",String(y)),t((await i.Z.get(s.S+"/api/complaints?"+n.toString(),{headers:(0,l.$V)()})).data)};(0,a.useEffect)(()=>{if(!(0,l.LP)()){b.push("/admin/login");return}i.Z.get(s.S+"/api/users?role=DO",{headers:(0,l.$V)()}).then(e=>{c([{id:1,username:"SR. REGISTRAR"},...e.data])}),i.Z.get(s.S+"/api/master/statuses",{headers:(0,l.$V)()}).then(e=>{let t=e.data||[];x(t);let n=t.find(e=>"Pending"===e.name);n?j(String(n.id)):j("")})},[]),(0,a.useEffect)(()=>{null!==y&&(0,l.LP)()&&S(1)},[y]);let w=async e=>{let t=m[e];if(!t){alert("Select a DO / SR. REGISTRAR to forward to");return}await i.Z.patch(s.S+"/api/complaints/"+e+"/assign",{userId:t},{headers:(0,l.$V)()}),S()},v=e=>"Closed"===e?"green":"In Progress"===e?"yellow":"gray",R=function(e){let t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(n);r.setDate(r.getDate()-1);let a={today:[],yesterday:[],earlier:[]};return e.forEach(e=>{let t=new Date(e.createdAt);t>=n?a.today.push(e):t>=r&&t<n?a.yesterday.push(e):a.earlier.push(e)}),a}(e.items||[]),k=(e,t)=>t.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,style:{paddingTop:"0.9rem",paddingBottom:"0.4rem"},children:(0,r.jsx)("span",{style:{background:"#0C512F",color:"white",padding:"4px 12px",borderRadius:6,fontSize:"0.8rem",fontWeight:600},children:e})})}),t.map(e=>{var t,a,i,o;return(0,r.jsxs)("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[(0,r.jsx)("td",{children:(0,r.jsx)(u(),{href:"/admin/view/".concat(e.id),style:{color:"#0C512F"},children:e.trackingId})}),(0,r.jsxs)("td",{children:[e.firstName," ",e.lastName||""]}),(0,r.jsx)("td",{children:(0,r.jsx)(h.Z,{tone:v(null===(t=e.status)||void 0===t?void 0:t.name),children:null===(a=e.status)||void 0===a?void 0:a.name})}),(0,r.jsx)("td",{children:(null===(i=e.assignedTo)||void 0===i?void 0:i.username)==="adminogra"?"SR. REGISTRAR":(null===(o=e.assignedTo)||void 0===o?void 0:o.username)||"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"0.3rem",alignItems:"center"},children:[(0,r.jsxs)("select",{className:"input",style:{width:150},value:m[e.id]||"",onChange:t=>p(n=>({...n,[e.id]:Number(t.target.value)})),children:[(0,r.jsx)("option",{value:"",children:"Forward to…"}),n.map(e=>(0,r.jsx)("option",{value:e.id,children:"adminogra"===e.username?"SR. REGISTRAR":e.username},e.id))]}),(0,r.jsx)(g,{variant:"ghost",onClick:()=>w(e.id),children:"Forward"})]})}),(0,r.jsx)("td",{children:new Date(e.createdAt).toLocaleString()})]},e.id)})]}):null;return(0,r.jsxs)(o.Z,{children:[(0,r.jsxs)("div",{className:"card",style:{marginBottom:"1rem"},children:[(0,r.jsx)("h1",{style:{fontSize:"1.3rem",color:"#0C512F",fontWeight:700},children:"DO Dashboard"}),(0,r.jsx)("p",{style:{color:"#555",marginTop:"0.4rem",fontSize:"0.85rem"},children:"Complaints assigned to you. You may forward them to SR. REGISTRAR or another DO."}),(0,r.jsxs)("div",{style:{marginTop:"0.75rem",display:"flex",gap:"0.5rem",flexWrap:"wrap",alignItems:"center"},children:[(0,r.jsx)("label",{style:{fontSize:"0.85rem",fontWeight:600,color:"#374151"},children:"Filter by Status:"}),(0,r.jsxs)("select",{className:"input",style:{maxWidth:220},value:y||"",onChange:e=>j(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"All Statuses"}),f.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:{width:"100%",fontSize:"0.85rem",borderCollapse:"collapse"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{background:"#0C512F",color:"white"},children:[(0,r.jsx)("th",{align:"left",style:{padding:8},children:"Tracking"}),(0,r.jsx)("th",{align:"left",style:{padding:8},children:"Name"}),(0,r.jsx)("th",{align:"left",style:{padding:8},children:"Status"}),(0,r.jsx)("th",{align:"left",style:{padding:8},children:"Assigned"}),(0,r.jsx)("th",{align:"left",style:{padding:8},children:"Forward"}),(0,r.jsx)("th",{align:"left",style:{padding:8},children:"Created"})]})}),(0,r.jsxs)("tbody",{children:[k("Today",R.today),k("Yesterday",R.yesterday),k("Earlier",R.earlier)]})]})})})]})}},1163:function(e,t,n){e.exports=n(9090)}},function(e){e.O(0,[66,664,888,774,179],function(){return e(e.s=5366)}),_N_E=e.O()}]);