(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{3807:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/view/[id]",function(){return n(8217)}])},9046:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(5893),o=n(1664),a=n.n(o),i=n(1013),s=n(7294);function l(e){let{children:t}=e,[n,o]=(0,s.useState)(null),[a,l]=(0,s.useState)(null),[c,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{o((0,i.cY)()),l((0,i.Ms)())},[]);let p="ADMIN"===n,g="SR_REGISTRAR"===n,u="DO"===n;return(0,r.jsxs)("div",{style:{minHeight:"100vh",display:"flex",background:"#f6f6f6",fontFamily:"sans-serif"},children:[(0,r.jsxs)("aside",{className:"print-hidden",onMouseEnter:()=>m(!1),onMouseLeave:()=>m(!0),style:{width:c?"70px":"240px",background:"#0C512F",color:"white",transition:"width 0.25s ease",overflow:"hidden",boxShadow:"2px 0 5px rgba(0,0,0,0.1)"},children:[(0,r.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,r.jsx)("img",{src:"/ogra-logo.png",alt:"OGRA Logo",style:{width:"36px",height:"36px",objectFit:"contain"}}),!c&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:700,fontSize:"0.95rem",lineHeight:"1.2"},children:"OGRA Dashboard"}),(0,r.jsx)("div",{style:{fontSize:"0.7rem",opacity:.8},children:"ADMIN"===n?"REGISTRAR":"".concat(a||"DO User"," (").concat(n||"No Role",")")})]})]}),(0,r.jsxs)("nav",{style:{padding:"0.75rem 0.5rem"},children:[(0,r.jsx)(d,{href:"/admin",label:"Dashboard",collapsed:c}),(p||g||u)&&(0,r.jsx)(d,{href:"/admin/complaints",label:"Complaints",collapsed:c}),(u||p)&&(0,r.jsx)(d,{href:"/admin/do",label:"DO Dashboard",collapsed:c}),(p||g)&&(0,r.jsx)(d,{href:"/admin/company-dashboard",label:"Company Dashboard",collapsed:c}),p&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{href:"/admin/users",label:"Manage Users",collapsed:c}),(0,r.jsx)(d,{href:"/admin/master-data",label:"Form Settings",collapsed:c})]})]}),(0,r.jsx)("div",{style:{marginTop:"auto",padding:"1rem",borderTop:"1px solid rgba(255,255,255,0.15)"},children:(0,r.jsx)("button",{onClick:()=>{(0,i.qz)(),window.location.href="/admin/login"},style:{width:"100%",padding:"0.5rem",background:"#3AA469",border:"none",borderRadius:"4px",color:"white",fontSize:"0.8rem",cursor:"pointer"},children:c?"⎋":"Logout"})})]}),(0,r.jsx)("main",{style:{flex:1,padding:"1.5rem"},children:(0,r.jsx)("div",{style:{maxWidth:1300,margin:"0 auto"},children:t})})]})}function d(e){let{href:t,label:n,collapsed:o}=e;return(0,r.jsx)("div",{style:{marginBottom:"0.3rem"},children:(0,r.jsxs)(a(),{href:t,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.45rem 0.6rem",borderRadius:"6px",textDecoration:"none",color:"white",fontSize:"0.85rem",transition:"background 0.2s, transform 0.1s"},children:[(0,r.jsx)("span",{style:{width:"8px",height:"8px",background:"#3AA469",borderRadius:"50%"}}),!o&&(0,r.jsx)("span",{style:{fontSize:"0.85rem"},children:n})]})})}},9875:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893);function o(e){let{tone:t="gray",children:n}=e,o={};switch(t){case"green":o={background:"#0C512F"};break;case"yellow":o={background:"#D97706"};break;case"blue":o={background:"#2563EB"};break;case"red":o={background:"#DC2626"};break;default:o={background:"#6B7280"}}return(0,r.jsx)("span",{style:{display:"inline-block",padding:"3px 8px",borderRadius:"6px",fontSize:"0.75rem",fontWeight:600,color:"white",textTransform:"capitalize",...o},children:n})}},3139:function(e,t,n){"use strict";n.d(t,{S:function(){return o}});let r="https://complaint.ogra.org.pk";if(!r){let{protocol:e,hostname:t}=window.location;r="".concat(e,"//").concat(t,":5000")}r||(r="http://localhost:5000");let o="https://complaint.ogra.org.pk"},1013:function(e,t,n){"use strict";function r(){return localStorage.getItem("token")||null}function o(e){e&&localStorage.setItem("token",e)}function a(){localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("username")}function i(){let e=r();return e?{Authorization:"Bearer "+e}:{}}function s(e,t){e&&localStorage.setItem("role",e),t&&localStorage.setItem("username",t)}function l(){return localStorage.getItem("role")}function d(){return localStorage.getItem("username")}n.d(t,{$V:function(){return i},IO:function(){return s},LP:function(){return r},Ms:function(){return d},cY:function(){return l},o4:function(){return o},qz:function(){return a}})},8217:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var r=n(5893),o=n(1163),a=n(7294),i=n(7066),s=n(9046),l=n(3139),d=n(1013),c=n(9875);let m=[{id:"ogra_standard",label:"OGRA – Lahore IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO LAHORE</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard1",label:"OGRA – Karachi IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO KARACHI</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard3",label:"OGRA – Peshawar IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO PESHAWAR</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard4",label:"OGRA – Multan IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO MULTAN</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard5",label:"OGRA – Quetta IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO Quetta</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard6",label:"OGRA – Sukkhur IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO SUKKHAR</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard7",label:"OGRA – Islamabad IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO Islamabad</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"ogra_standard8",label:"OGRA – Rawalpindi IOM (Registrar)",subject:"LOW/ ZERO GAS PRESSURE",bodyHtml:"<p><strong>TO: DO Rawalpindi</strong></p><b></b><b></b><p><strong>From: Senior REGISTRAR</strong></p><p>This office has received an application/complaint from <strong>{complainantName}</strong>, on the above subject. The complaint has been assessed under Regulation-6 of CRPR, 2003 and is hereby accepted and forwarded to Designated Officer (D.O) for further necessary action, please.</p><p>(ABDUL BASIT QURESHI)<br/> SR. REGISTRAR<br/></p><p><strong>Copy to:</strong><br/>{complainantName}<br/>{complainantAddress}</p>"},{id:"reminder",label:"Reminder to DO",subject:"Reminder – complaint {trackingId}",bodyHtml:"<p>Dear Sir/Madam,</p><p>This is a reminder regarding the complaint bearing Tracking ID {trackingId} which is still pending.</p><p>You are requested to expedite the matter and furnish your report at the earliest.</p><p>Regards,<br/>SR. REGISTRAR</p>"}];function p(){var e,t,n,p,b,f,x,y;let j;let{id:S}=(0,o.useRouter)().query,[R,v]=(0,a.useState)(null),[I,A]=(0,a.useState)(""),[O,T]=(0,a.useState)(""),[C,D]=(0,a.useState)("PUBLIC"),[E,k]=(0,a.useState)([]),[w,B]=(0,a.useState)(!1),[N,F]=(0,a.useState)(""),[L,z]=(0,a.useState)(""),[M,G]=(0,a.useState)(""),[P,U]=(0,a.useState)(""),[H,_]=(0,a.useState)([]),[W,Z]=(0,a.useState)(!1),[Q,V]=(0,a.useState)([]),[$,q]=(0,a.useState)(""),[K,Y]=(0,a.useState)(!1),[X,J]=(0,a.useState)(null),[ee,et]=(0,a.useState)(""),[en,er]=(0,a.useState)(""),[eo,ea]=(0,a.useState)(""),[ei,es]=(0,a.useState)(!1),el=(0,a.useRef)(null),ed=async()=>{try{T("");let e=await i.Z.get(l.S+"/api/complaints/"+S,{headers:(0,d.$V)()}),t=(e.data.attachments||[]).map(e=>({...e,path:e.path&&e.path.startsWith("/")?e.path:"/"+(e.path||"").replace(/^\/?/,"")})),n=(e.data.logs||[]).map(e=>{var t,n;return{...e,user:{username:(null===(t=e.user)||void 0===t?void 0:t.username)||"System",role:(null===(n=e.user)||void 0===n?void 0:n.role)||""}}}),r=e.data.disposal||null;v({...e.data,attachments:t,logs:n,disposal:r})}catch(e){console.error("Error loading complaint",e),T("Could not connect to backend. Please make sure the API is running and API_BASE is correct.")}},ec=async()=>{if(S){B(!0),F("");try{let e=await i.Z.get(l.S+"/api/complaints/"+S+"/ioms",{headers:(0,d.$V)()});k(e.data||[])}catch(e){console.error("Error loading IOMs",e),F("Failed to load IOMs")}finally{B(!1)}}},em=async()=>{try{let e=await i.Z.get(l.S+"/api/users?role=DO",{headers:(0,d.$V)()});V(e.data||[])}catch(e){console.error("Error loading DO users",e)}};(0,a.useEffect)(()=>{S&&(ed(),ec(),em())},[S]);let ep=async()=>{if(!I.trim())return;let e=I.trim();"PUBLIC"===C?e="[PUBLIC] ".concat(e):"INTERNAL"===C&&(e="[INTERNAL] ".concat(e)),await i.Z.post(l.S+"/api/complaints/"+S+"/remark",{comments:e},{headers:(0,d.$V)()}),A(""),D("PUBLIC"),ed()},eg=e=>{"undefined"!=typeof document&&document.execCommand(e,!1,null)},eu=e=>{"undefined"!=typeof document&&document.execCommand("justify"+e,!1,null)},eh=async()=>{if(F(""),z(""),!P){F("Please select a DO to send the IOM to.");return}let e=el.current?el.current.innerHTML:"";if(!e.replace(/<br\s*\/?>/gi,"\n").replace(/<[^>]+>/g,"").trim()){F("IOM body cannot be empty.");return}try{Z(!0);let t=new FormData;t.append("toUserId",P),t.append("subject",M||""),t.append("bodyHtml",e),t.append("senderRole",(0,d.cY)()),t.append("senderUsername",(0,d.Ms)()),H.forEach(e=>{t.append("iomFiles",e)}),await i.Z.post(l.S+"/api/complaints/"+S+"/ioms",t,{headers:{...(0,d.$V)(),"Content-Type":"multipart/form-data"}}),z("IOM sent successfully."),F(""),G(""),U(""),_([]),q(""),el.current&&(el.current.innerHTML=""),ec(),ed()}catch(e){var t,n;console.error("Error sending IOM",e),F((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||"Failed to send IOM")}finally{Z(!1)}},eb=async()=>{er(""),ea("");try{if(es(!0),!ee.trim()&&!X){er("Please add a decision note or attach a decision file."),es(!1);return}let e=new FormData;e.append("note",ee||""),X&&e.append("decisionFile",X),await i.Z.post(l.S+"/api/complaints/"+S+"/dispose",e,{headers:{...(0,d.$V)(),"Content-Type":"multipart/form-data"}}),ea("Complaint marked as disposed of successfully."),er(""),J(null),et(""),Y(!1),ed()}catch(n){var e,t;console.error("Error disposing complaint",n),er((null==n?void 0:null===(t=n.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||(null==n?void 0:n.message)||"Failed to mark complaint as disposed.")}finally{es(!1)}},ef=E&&E.length?E[0]:null;if(!R)return(0,r.jsx)(s.Z,{children:(0,r.jsx)("div",{className:"card",children:O?(0,r.jsx)("div",{style:{color:"red"},children:O}):"Loading..."})});let ex=(null==ef?void 0:null===(e=ef.to)||void 0===e?void 0:e.username)||(null==ef?void 0:ef.toUserId)||"Dealing Officer",ey=(null==ef?void 0:null===(t=ef.from)||void 0===t?void 0:t.username)||(null===(n=R.assignedTo)||void 0===n?void 0:n.username)||"SR. REGISTRAR",ej=(null==ef?void 0:ef.createdAt)?new Date(ef.createdAt).toLocaleDateString():new Date(R.createdAt).toLocaleDateString(),eS=R.trackingId?"Complaint Ref: ".concat(R.trackingId):"",eR=R.disposal||null,ev=R.createdAt?new Date(R.createdAt):null,eI="-",eA="-";if(ev){let e=new Date(ev.getTime());e.setDate(e.getDate()+10),eI=e.toLocaleDateString(),eA=(null===(y=R.status)||void 0===y?void 0:y.name)==="Closed"?"Closed":new Date>e?"Overdue":"On Time"}let eO=e=>{let t=(null==R?void 0:R.trackingId)||"",n="".concat((null==R?void 0:R.firstName)||""," ").concat((null==R?void 0:R.lastName)||"").trim()||"the complainant",r=(null==R?void 0:R.address)||"",o=e=>(e||"").replace(/\{trackingId\}/g,t).replace(/\{complainantName\}/g,n).replace(/\{complainantAddress\}/g,r);G(o(e.subject)),el.current&&(el.current.innerHTML=o(e.bodyHtml))};return(0,r.jsxs)(s.Z,{children:[(0,r.jsx)("style",{children:"\n          .iom-print-page {\n            display: none;\n          }\n\n          @media print {\n            body {\n              background: white !important;\n            }\n            .print-header {\n              display: flex !important;\n            }\n            .print-hidden {\n              display: none !important;\n            }\n            .card {\n              box-shadow: none !important;\n              border: none !important;\n            }\n            .iom-print-page {\n              display: block !important;\n              page-break-after: always;\n            }\n          }\n        "}),ef&&(0,r.jsxs)("div",{className:"iom-print-page",style:{background:"white",padding:"2.5cm 2cm",fontSize:"0.9rem",lineHeight:1.5},children:[(0,r.jsxs)("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[(0,r.jsx)("img",{src:"/ogra-logo.png",alt:"OGRA Logo",style:{width:"36px",height:"36px",objectFit:"contain"}}),(0,r.jsx)("div",{style:{fontWeight:700,fontSize:"1.05rem",color:"#0C512F",textTransform:"uppercase"},children:"Oil & Gas Regulatory Authority (OGRA)"}),(0,r.jsx)("div",{style:{fontWeight:600,fontSize:"0.85rem",marginTop:4},children:"(OFFICE OF THE REGISTRAR)"}),(0,r.jsx)("div",{style:{fontWeight:600,fontSize:"0.95rem",marginTop:6,textTransform:"uppercase"},children:"INTER OFFICE MEMO"})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.8rem",fontSize:"0.85rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Ref:"})," ",eS||"-"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Date:"})," ",ej]})]}),(0,r.jsxs)("div",{style:{marginBottom:"0.8rem",fontSize:"0.9rem"},children:[(0,r.jsxs)("div",{style:{marginBottom:"0.2rem"},children:[(0,r.jsx)("strong",{children:"To:"})," ",ex]}),(0,r.jsxs)("div",{style:{marginBottom:"0.2rem"},children:[(0,r.jsx)("strong",{children:"From:"})," ",ey]}),(0,r.jsxs)("div",{style:{marginBottom:"0.2rem"},children:[(0,r.jsx)("strong",{children:"Subject:"})," ",ef.subject||"-"]}),(0,r.jsxs)("div",{style:{marginBottom:"0.2rem"},children:[(0,r.jsx)("strong",{children:"Complaint No.:"})," ",R.trackingId||"-"]})]}),(0,r.jsx)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"0.8rem",marginTop:"0.4rem",fontSize:"0.9rem"},dangerouslySetInnerHTML:{__html:ef.bodyHtml||""}})]}),(0,r.jsx)("div",{className:"print-header",style:{display:"none",justifyContent:"center",marginBottom:"1rem",textAlign:"center"},children:(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{src:"/ogra-logo.png",alt:"OGRA Logo",style:{width:"36px",height:"36px",objectFit:"contain"}}),(0,r.jsx)("h2",{style:{fontSize:"1.4rem",margin:0,color:"#0C512F"},children:"Oil & Gas Regulatory Authority (OGRA)"}),(0,r.jsxs)("p",{style:{margin:0,fontSize:"0.9rem"},children:["Complaint Report – Tracking ID: ",R.trackingId]})]})}),(0,r.jsxs)("div",{className:"card",style:{background:"white",padding:"1.5rem",borderRadius:10,boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{style:{fontSize:"1.3rem",color:"#0C512F",fontWeight:700},children:"Complaint Details"}),(0,r.jsxs)("div",{style:{fontSize:"0.85rem",color:"#4B5563",marginTop:"0.15rem"},children:[(0,r.jsx)("strong",{children:"Tracking ID:\xa0"}),(0,r.jsx)("span",{style:{fontFamily:"monospace",background:"#F3F4F6",padding:"2px 6px",borderRadius:4,border:"1px solid #E5E7EB"},children:R.trackingId||"-"})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"0.4rem",alignItems:"center"},children:[(0,r.jsx)(c.Z,{tone:"Closed"===(j=null===(p=R.status)||void 0===p?void 0:p.name)?"green":"In Progress"===j?"yellow":"gray",children:null===(b=R.status)||void 0===b?void 0:b.name}),(0,r.jsx)("button",{className:"btn btn-primary print-hidden",onClick:()=>window.print(),style:{background:"#0C512F",color:"white",border:"none",borderRadius:6,padding:"0.5rem 1rem"},children:"Print / PDF"}),(0,r.jsx)("button",{className:"btn print-hidden",onClick:()=>Y(e=>!e),style:{background:"#b91c1c",color:"white",border:"none",borderRadius:6,padding:"0.5rem 1rem"},children:"Disposed of"})]})]}),O&&(0,r.jsx)("div",{style:{background:"#fee2e2",borderRadius:6,padding:"0.5rem 0.75rem",color:"#b91c1c",marginBottom:"0.8rem",fontSize:"0.85rem"},children:O}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.5rem 1.5rem",fontSize:"0.9rem",marginBottom:"1.25rem"},children:[(0,r.jsx)(g,{label:"Name",value:"".concat(R.firstName," ").concat(R.lastName||"")}),(0,r.jsx)(g,{label:"CNIC",value:R.cnic}),(0,r.jsx)(g,{label:"Email",value:R.email}),(0,r.jsx)(g,{label:"Assigned To",value:(null===(f=R.assignedTo)||void 0===f?void 0:f.username)==="adminogra"?"SR. REGISTRAR":(null===(x=R.assignedTo)||void 0===x?void 0:x.username)||"-"}),(0,r.jsx)(g,{label:"Created",value:new Date(R.createdAt).toLocaleString()}),(0,r.jsx)(g,{label:"Due Date (10-day SLA)",value:eI}),(0,r.jsx)(g,{label:"SLA Status",value:eA}),(0,r.jsx)(u,{label:"Address",value:R.address})]}),(0,r.jsxs)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"1rem",marginBottom:"1.25rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",color:"#0C512F",marginBottom:8},children:"Complaint Details (Points 1 to 8)"}),(0,r.jsx)(h,{complaint:R.complaint})]}),(0,r.jsxs)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"1rem",marginBottom:"1.25rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",color:"#0C512F",marginBottom:8},children:"Attachments"}),(0,r.jsx)("ul",{style:{paddingLeft:"1rem",fontSize:"0.9rem"},children:R.attachments.length?R.attachments.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:l.S+e.path,target:"_blank",rel:"noreferrer",style:{color:"#0C512F"},children:e.path.split("/").pop()})},e.id)):(0,r.jsx)("li",{children:"None"})})]}),eR&&(0,r.jsxs)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"1rem",marginBottom:"1.25rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",color:"#b91c1c",marginBottom:8},children:"Final OGRA Decision / Disposed Of"}),(0,r.jsxs)("div",{style:{fontSize:"0.9rem",marginBottom:4},children:[(0,r.jsx)("strong",{children:"Date:"})," ",eR.createdAt?new Date(eR.createdAt).toLocaleString():"-"]}),eR.note&&(0,r.jsxs)("div",{style:{fontSize:"0.9rem",marginBottom:4},children:[(0,r.jsx)("strong",{children:"Note:"})," ",eR.note]}),eR.filePath&&(0,r.jsxs)("div",{style:{fontSize:"0.9rem"},children:[(0,r.jsx)("strong",{children:"Decision File: "}),(0,r.jsx)("a",{href:l.S+eR.filePath,target:"_blank",rel:"noreferrer",style:{color:"#0C512F"},children:"Download Decision"})]})]}),K&&(0,r.jsxs)("div",{className:"print-hidden",style:{borderTop:"1px solid #fee2e2",paddingTop:"1rem",marginBottom:"1.25rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",color:"#b91c1c",marginBottom:8},children:"Mark Complaint as Disposed Of"}),(0,r.jsxs)("div",{style:{marginBottom:"0.6rem"},children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:4},children:"Decision Note (optional)"}),(0,r.jsx)("textarea",{className:"input",rows:3,value:ee,onChange:e=>et(e.target.value),placeholder:"Short note about the decision (optional)..."})]}),(0,r.jsxs)("div",{style:{marginBottom:"0.6rem"},children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:4},children:"Decision File (PDF / Word) – optional"}),(0,r.jsx)("input",{type:"file",accept:".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:e=>{var t;J((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),X&&(0,r.jsxs)("div",{style:{fontSize:"0.8rem",color:"#555",marginTop:4},children:["Selected: ",X.name]})]}),en&&(0,r.jsx)("div",{style:{background:"#fee2e2",borderRadius:4,padding:"0.4rem 0.6rem",color:"#b91c1c",fontSize:"0.8rem",marginBottom:"0.4rem"},children:en}),eo&&(0,r.jsx)("div",{style:{background:"#dcfce7",borderRadius:4,padding:"0.4rem 0.6rem",color:"#166534",fontSize:"0.8rem",marginBottom:"0.4rem"},children:eo}),(0,r.jsx)("button",{className:"btn btn-primary",onClick:eb,disabled:ei,style:{background:"#b91c1c",border:"none",color:"white",padding:"0.45rem 1rem",borderRadius:6},children:ei?"Marking as Disposed...":"Mark Disposed"})]}),(0,r.jsxs)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"1rem",marginBottom:"1.25rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",color:"#0C512F",marginBottom:8},children:"Internal Office Memo (IOM)"}),(0,r.jsxs)("div",{className:"print-hidden",style:{border:"1px solid #e5e7eb",borderRadius:8,padding:"0.8rem",marginBottom:"0.8rem",background:"#f9fafb"},children:[(0,r.jsxs)("div",{style:{marginBottom:"0.6rem"},children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:4,color:"#0C512F"},children:"Forward To (DO)"}),(0,r.jsxs)("select",{className:"input",value:P,onChange:e=>U(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Select Dealing Officer"}),Q.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.username," (",e.email,")"]},e.id))]}),(0,r.jsx)("small",{style:{color:"#666",fontSize:"0.75rem"},children:"Complaint will also be considered forwarded to this DO."})]}),(0,r.jsxs)("div",{style:{marginBottom:"0.6rem"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4,gap:"0.5rem"},children:[(0,r.jsx)("label",{style:{fontSize:"0.85rem",color:"#0C512F"},children:"Subject"}),(0,r.jsxs)("select",{className:"input",style:{maxWidth:260,fontSize:"0.8rem"},value:$,onChange:e=>{let t=e.target.value;q(t);let n=m.find(e=>e.id===t);n&&eO(n)},children:[(0,r.jsx)("option",{value:"",children:"IOM Templates…"}),m.map(e=>(0,r.jsx)("option",{value:e.id,children:e.label},e.id))]})]}),(0,r.jsx)("input",{className:"input",value:M,onChange:e=>G(e.target.value),placeholder:"Enter IOM subject"})]}),(0,r.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:6,padding:4,display:"flex",flexWrap:"wrap",gap:4,marginBottom:4,background:"#f3f4f6"},children:[(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eg("bold"),style:{padding:"0.15rem 0.5rem"},children:"B"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eg("italic"),style:{padding:"0.15rem 0.5rem",fontStyle:"italic"},children:"I"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eg("underline"),style:{padding:"0.15rem 0.5rem",textDecoration:"underline"},children:"U"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eg("insertUnorderedList"),style:{padding:"0.15rem 0.5rem"},children:"• List"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eg("insertOrderedList"),style:{padding:"0.15rem 0.5rem"},children:"1. List"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eu("Left"),style:{padding:"0.15rem 0.5rem"},children:"⬅"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eu("Center"),style:{padding:"0.15rem 0.5rem"},children:"⬌"}),(0,r.jsx)("button",{type:"button",className:"btn",onClick:()=>eu("Right"),style:{padding:"0.15rem 0.5rem"},children:"➡"})]}),(0,r.jsx)("div",{ref:el,contentEditable:!0,style:{minHeight:140,border:"1px solid #e5e7eb",borderRadius:6,padding:8,background:"white",fontSize:"0.9rem",marginBottom:"0.5rem"}}),(0,r.jsxs)("div",{style:{marginBottom:"0.6rem"},children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:4,color:"#0C512F"},children:"Attach IOM file(s) (PDF / Word / Images)"}),(0,r.jsx)("input",{type:"file",multiple:!0,onChange:e=>{_(Array.from(e.target.files||[]))}}),H.length>0&&(0,r.jsxs)("div",{style:{fontSize:"0.8rem",color:"#555",marginTop:4},children:[H.length," file(s) selected"]})]}),N&&(0,r.jsx)("div",{style:{background:"#fee2e2",borderRadius:4,padding:"0.4rem 0.6rem",color:"#b91c1c",fontSize:"0.8rem",marginBottom:"0.4rem"},children:N}),L&&(0,r.jsx)("div",{style:{background:"#dcfce7",borderRadius:4,padding:"0.4rem 0.6rem",color:"#166534",fontSize:"0.8rem",marginBottom:"0.4rem"},children:L}),(0,r.jsx)("button",{className:"btn btn-primary",onClick:eh,disabled:W,style:{background:"#0C512F",border:"none",color:"white",padding:"0.45rem 1rem",borderRadius:6},children:W?"Sending IOM...":"Send IOM"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{style:{fontSize:"0.95rem",color:"#0C512F",marginBottom:"0.4rem"},children:"IOM History"}),w?(0,r.jsx)("div",{children:"Loading IOMs..."}):E.length?(0,r.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:E.map(e=>{var t,n;return(0,r.jsxs)("li",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:"0.6rem",marginBottom:"0.5rem",background:"#f9fafb"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[(0,r.jsx)("strong",{children:e.subject||"IOM"}),(0,r.jsx)("span",{style:{fontSize:"0.75rem",color:"#6b7280",marginLeft:8},children:e.createdAt?new Date(e.createdAt).toLocaleString():""})]}),(0,r.jsxs)("div",{style:{fontSize:"0.8rem",color:"#555",marginBottom:4},children:["From:"," ",(0,r.jsx)("strong",{style:{color:"#0C512F"},children:(null===(t=e.from)||void 0===t?void 0:t.username)||e.fromUserId||"Unknown"})," ",e.to&&(0,r.jsxs)(r.Fragment,{children:["\xa0→ To:"," ",(0,r.jsx)("strong",{style:{color:"#0C512F"},children:(null===(n=e.to)||void 0===n?void 0:n.username)||e.toUserId||"Unknown"})]})]}),(0,r.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:6,padding:6,background:"white",fontSize:"0.9rem",marginBottom:4},dangerouslySetInnerHTML:{__html:e.bodyHtml||""}}),e.attachments&&e.attachments.length>0&&(0,r.jsxs)("div",{style:{fontSize:"0.8rem"},children:[(0,r.jsx)("strong",{children:"Attachments: "}),e.attachments.map(e=>(0,r.jsxs)("a",{href:l.S+e.path,target:"_blank",rel:"noreferrer",style:{marginRight:8,color:"#0C512F"},children:["File #",e.id]},e.id))]})]},e.id)})}):(0,r.jsx)("div",{style:{fontSize:"0.85rem",color:"#555"},children:"No IOMs yet for this complaint."})]})]}),(0,r.jsxs)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"1rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1rem",color:"#0C512F",marginBottom:8},children:"Logs / Remarks"}),(0,r.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:R.logs.length?R.logs.map(e=>{let t=e.user.username;"DO"===e.user.role?t=e.user.username:"System"===e.user.username?t="System":"ADMIN"===e.user.role&&(t="Admin");let{visibility:n,text:o}=function(e){let t=(e||"").trim();return/^\[PUBLIC\]/i.test(t)?{visibility:"PUBLIC",text:t.replace(/^\[PUBLIC\]\s*/i,"")}:/^\[INTERNAL\]/i.test(t)?{visibility:"INTERNAL",text:t.replace(/^\[INTERNAL\]\s*/i,"")}:{visibility:"DEFAULT",text:t}}(e.comments),a=function(e){if(!e)return"";let t=/^Status changed to\s+(\d+)/i.exec(e);if(!t)return e;let n=t[1];return"Status changed to ".concat({1:"Pending",2:"In Progress",3:"Closed"}[n]||n)}(o);return(0,r.jsxs)("li",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:"0.6rem",marginBottom:"0.5rem",background:"#f9fafb"},children:[(0,r.jsxs)("div",{style:{fontSize:"0.75rem",color:"#555",marginBottom:"0.25rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsxs)("span",{children:[new Date(e.createdAt).toLocaleString()," —"," ",(0,r.jsx)("strong",{style:{color:"#0C512F"},children:t})]}),"INTERNAL"===n&&(0,r.jsx)("span",{style:{padding:"1px 6px",borderRadius:999,fontSize:"0.65rem",background:"#FEE2E2",color:"#B91C1C",whiteSpace:"nowrap"},children:"Internal"}),"PUBLIC"===n&&(0,r.jsx)("span",{style:{padding:"1px 6px",borderRadius:999,fontSize:"0.65rem",background:"#DBEAFE",color:"#1D4ED8",whiteSpace:"nowrap"},children:"Public"})]}),(0,r.jsx)("div",{style:{color:"#333",fontSize:"0.85rem"},children:a})]},e.id)}):(0,r.jsx)("li",{children:"No remarks yet"})}),(0,r.jsxs)("div",{className:"print-hidden",style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.6rem",alignItems:"center"},children:[(0,r.jsx)("input",{className:"input",placeholder:"Add remark...",value:I,onChange:e=>A(e.target.value),style:{flex:1,minWidth:0}}),(0,r.jsxs)("select",{className:"input",value:C,onChange:e=>D(e.target.value),style:{width:150,fontSize:"0.8rem"},children:[(0,r.jsx)("option",{value:"PUBLIC",children:"Public"}),(0,r.jsx)("option",{value:"INTERNAL",children:"Internal"})]}),(0,r.jsx)("button",{className:"btn btn-primary",onClick:ep,style:{background:"#0C512F",border:"none",color:"white",padding:"0.45rem 1rem",borderRadius:6},children:"Add"})]})]})]})]})}function g(e){let{label:t,value:n}=e;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{style:{color:"#0C512F"},children:[t,":"]})," ",n||"-"]})}function u(e){let{label:t,value:n}=e;return(0,r.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,r.jsxs)("strong",{style:{color:"#0C512F"},children:[t,":"]})," ",n||"-"]})}function h(e){let{complaint:t}=e;if(!t)return(0,r.jsx)("div",{children:"-"});let n=t.split(/\r?\n/).filter(e=>""!==e.trim());return(0,r.jsx)("div",{style:{fontSize:"0.9rem"},children:n.map((e,t)=>{let n=e.indexOf(":"),o="",a=e;return -1!==n&&(o=e.slice(0,n+1),a=e.slice(n+1).trim()),(0,r.jsx)("div",{style:{marginBottom:"0.25rem"},children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("strong",{children:o})," ",a]}):e},t)})})}},1163:function(e,t,n){e.exports=n(9090)}},function(e){e.O(0,[66,664,888,774,179],function(){return e(e.s=3807)}),_N_E=e.O()}]);